# Инструмент отчётов
## Создание проекта
Перед созданием проекта необходимо скачать нужные вам xsd схемы.  
Чтобы создать проект, нужно нажать «Проект -> Создать проект» в верхнем меню .

![CreateProjectImage](https://github.com/ParmaGIS/ParmaDocumentation/assets/72987701/74b5383b-fdf1-477a-8ad1-38a8522c98eb)

После этого откроется окно создания проекта, которое имеет 4 поля для заполнения:
1.	Имя проекта
2.	Расположение
3.	Схема отчёта
4.	Дополнительные схемы

Имя проекта – название, которое требуется задать проекту.  
Расположение – путь к директории, куда требуется сохранить проект.  
Схема отчёта – путь до схемы отчёта.  
Дополнительные схемы – пути до файлов дополнительных схем.  

![CreateProjectImage2](https://github.com/ParmaGIS/ParmaDocumentation/assets/72987701/5f48c6a6-9406-45e8-827d-6f50209443d4)

![CreateProjectImage3](https://github.com/ParmaGIS/ParmaDocumentation/assets/72987701/a20a74e5-c20a-462b-924b-dcd2dc078b0c)


После заполнения всех полей нужно нажать кнопку «Создать проект».
При успешном создании проекта будет открыт отчёт. Если при создании проекта возникнут ошибки, они будут отображены внизу окна создания проекта. 

![CreateProjectErrorsImage](https://github.com/ParmaGIS/ParmaDocumentation/assets/72987701/57a86cd6-cd39-4dd2-92a3-9df66d128052)

## Открытие проекта
Чтобы открыть ранее созданный проект, нужно нажать «Проект -> Открыть проект» в верхнем меню. Затем нужно выбрать архив с проектом. После этого откроется проект.

![OpenProjectImage](https://github.com/ParmaGIS/ParmaDocumentation/assets/72987701/5b60fb31-e127-4987-88f7-2d6b08369447)


После открытия проекта на экране появится сгенерированный интерфейс отчёта. Если открылся интерфейс не всего отчёта, а одной из его сущностей, нужно нажать "Проект -> Выбрать сущность" в верхнем меню и выбрать сущность отчёта.

![SelectEntityImage](https://github.com/ParmaGIS/ParmaDocumentation/assets/72987701/19305cff-e04f-45d0-9773-11bfaca0af71)

## Загрузка данных отчёта
Чтобы загрузить данные отчёта, нужно нажать «Отчёт -> Загрузить отчёт» в верхнем меню и выбрать нужный файл. Заполненные отчёты имеют формат ```.xml```. 
После загрузки данных отчёта, поля интерфейса будут заполнены.
![LoadDataImage](https://github.com/ParmaGIS/ParmaDocumentation/assets/72987701/0b3dda04-9dba-4725-9567-5db47863a732)

## Сохранение данных отчёта
Чтобы сохранить данные отчёта, нужно нажать кнопку «Отчёт -> Сохранить отчёт с валидацией» в верхнем меню. После этого начнется валидация отчёта в соответствие с xsd схемой. Если валидация прошла успешно, нужно выбрать путь для сохранения отчёта и отчёт сохранится. Если при валидации произошли ошибки, будет оповещено о несоответствиях заполненного отчёта с xsd схемой.
![SaveDataImage](https://github.com/ParmaGIS/ParmaDocumentation/assets/72987701/8cdf14d2-35db-4751-9223-87c9eef7553e)

## Редактирование макета
Интерфейс состоит из множества блоков с заголовками и полями для ввода. Чтобы редактировать макет интерфейса, нужно перейти в режим редактирования. Для этого нужно нажать кнопку «Макет -> Редактировать макет» в верхнем меню. Чтобы выйти из режима редактирования, нужно нажать кнопку «Макет -> Закончить редактирование».

![DefaultModeImage](https://github.com/ParmaGIS/ParmaDocumentation/assets/72987701/2de1beb7-9f30-47de-8c8c-149e86b7ff5d)

В режиме редактирования можно переименовывать блоки интерфейса, изменять их порядок, размер и объединять в группы.  
Для изменения порядка блоков интерфейса нужно перетащить левой кнопкой мыши один блок на другой (При перетаскивании на группу, нужно перетаскивать на её заголовок. Иначе элемент добавится в группу).  
Для изменения размеров блока нужно нажать на нужный элемент. После этого появятся границы, за которые можно расстягивать элемент, тем самым изменяя его размер. 

![ResizeImage](https://github.com/ParmaGIS/ParmaDocumentation/assets/72987701/d28f84c7-5bf8-48b2-ae6e-d500f36949d7)

Чтобы сохранить макет, нужно нажать кнопку «Макет -> Сохранить макет» в верхнем меню. При последующих открытиях проекта, сохраненный макет будет автоматически загружаться.

Чтобы отменить изменения макета, нужно нажать кнопку «Макет -> Отменить изменения» в верхнем меню. После этого все изменения сбросятся до момента последнего сохранения макета.

![LayoutImage](https://github.com/ParmaGIS/ParmaDocumentation/assets/72987701/90635ab5-3840-4c31-aa77-f42331bf7ea0)

### Обозреватель свойств
Для настройки элементов также доступно окно "Обозреватель свойств". Чтобы его открыть, нужно в режиме редактирования нажать на любой элемент интерфейса.
В обозревателе свойств доступна возможность изменять имя элемента интерфейса и задавать ему точный размер. При установке опции "Автоматическая ширина / Автоматическая высота" элемент будет расстягиваться до контента который он содержит.
Для групп в обозревателе свойств также есть возможность создания новой группы и удаления данной группы.

![InspectorImage](https://github.com/ParmaGIS/ParmaDocumentation/assets/72987701/842b12db-5166-421e-a4b2-d5f5f56124ba)

### Группы
Группа - это элемент интерфейса который может содержать другие элементы интерфейса.
Внутри каждой группы имеется возможность создать другую группу. Для этого нужно открыть обозреватель свойств нужной группы и нажать кнопку «Создать группу».

![CreateGroupImage](https://github.com/ParmaGIS/ParmaDocumentation/assets/72987701/7df134e8-fc32-4e23-9987-027da0c55f6b)

Чтобы добавить блок интерфейса в группу, нужно перетащить нужный блок внутрь группы.  

![FillGroupImage](https://github.com/ParmaGIS/ParmaDocumentation/assets/72987701/0e38555f-bf81-4421-b357-e2a9cf792f73)

Чтобы удалить блок интерфейса из группы, нужно вытащить его в другую группу.  

Чтобы удалить группу, нужно открыть обозреватель свойств группы и нажать кнопку «Удалить группу». После удаления группы все её элементы будут вынесены в родительский элемент этой группы.
